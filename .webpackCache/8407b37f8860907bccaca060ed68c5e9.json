{"remainingRequest":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js!C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\aulaService.ts","dependencies":[{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\aulaService.ts","mtime":1704571326200},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOw0KdmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7DQogICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9DQogICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH0NCiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQ0KICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7DQogICAgfSk7DQp9Ow0KdmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHsNCiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnOw0KICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCAidGhyb3ciOiB2ZXJiKDEpLCAicmV0dXJuIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnOw0KICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfQ0KICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHsNCiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTsNCiAgICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHsNCiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbInJldHVybiJdIDogb3BbMF0gPyB5WyJ0aHJvdyJdIHx8ICgodCA9IHlbInJldHVybiJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDsNCiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTsNCiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHsNCiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9Ow0KICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTsNCiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7DQogICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTsNCiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pOw0KICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9DQogICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9Ow0KICAgIH0NCn07DQp2YXIgX19yZXN0ID0gKHRoaXMgJiYgdGhpcy5fX3Jlc3QpIHx8IGZ1bmN0aW9uIChzLCBlKSB7DQogICAgdmFyIHQgPSB7fTsNCiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMCkNCiAgICAgICAgdFtwXSA9IHNbcF07DQogICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gImZ1bmN0aW9uIikNCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKQ0KICAgICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dOw0KICAgICAgICB9DQogICAgcmV0dXJuIHQ7DQp9Ow0KT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsNCmV4cG9ydHMuc2F2ZVByb2dyZXNzID0gZXhwb3J0cy51cGRhdGVBdWxhID0gZXhwb3J0cy5saXN0QXVsYXMgPSBleHBvcnRzLmdldEF1bGEgPSBleHBvcnRzLmRlbGV0ZUF1bGEgPSBleHBvcnRzLmNyZWF0ZUF1bGEgPSBleHBvcnRzLm1haW4gPSB2b2lkIDA7DQp2YXIgc2F2ZVByb2dyZXNzXzEgPSByZXF1aXJlKCIuL3NhdmVQcm9ncmVzcyIpOyAvLyBJbXBvcnRlIG8gbm92byBoYW5kbGVyDQp2YXIgYXV0aF8xID0gcmVxdWlyZSgiQC9saWIvYXV0aCIpOyAvLyBJbXBvcnRlIG8gbcOzZHVsbyBkZSBhdXRlbnRpY2HDp8Ojbw0KdmFyIHJvdXRlcl8xID0gcmVxdWlyZSgiQC9saWIvcm91dGVyIik7DQp2YXIgY3JlYXRlQXVsYV8xID0gcmVxdWlyZSgiLi9jcmVhdGVBdWxhIik7DQp2YXIgZGVsZXRlQXVsYV8xID0gcmVxdWlyZSgiLi9kZWxldGVBdWxhIik7DQp2YXIgZ2V0QXVsYV8xID0gcmVxdWlyZSgiLi9nZXRBdWxhIik7DQp2YXIgbGlzdEF1bGFzXzEgPSByZXF1aXJlKCIuL2xpc3RBdWxhcyIpOw0KdmFyIHVwZGF0ZUF1bGFfMSA9IHJlcXVpcmUoIi4vdXBkYXRlQXVsYSIpOw0KdmFyIHJvdXRlciA9ICgwLCByb3V0ZXJfMS5idWlsZFJvdXRlcikoKTsNCnJvdXRlci5wb3N0KCcvYXVsYXMnLCBhdXRoXzEuYXV0aC52ZXJpZnlMb2dnZWQoY3JlYXRlQXVsYV8xLmNyZWF0ZUF1bGFIYW5kbGVyKSk7DQpyb3V0ZXIuZ2V0KCcvYXVsYXMve2F1bGFJZH0nLCBhdXRoXzEuYXV0aC52ZXJpZnlMb2dnZWQoZ2V0QXVsYV8xLmdldEF1bGFIYW5kbGVyKSk7DQpyb3V0ZXIucHV0KCcvYXVsYXMnLCBhdXRoXzEuYXV0aC52ZXJpZnlMb2dnZWQodXBkYXRlQXVsYV8xLnVwZGF0ZUF1bGFIYW5kbGVyKSk7DQpyb3V0ZXIuZ2V0KCcvYXVsYXMnLCBhdXRoXzEuYXV0aC52ZXJpZnlMb2dnZWQobGlzdEF1bGFzXzEubGlzdEF1bGFzSGFuZGxlcikpOw0Kcm91dGVyLmRlbGV0ZSgnL2F1bGFzL3thdWxhSWR9JywgYXV0aF8xLmF1dGgudmVyaWZ5TG9nZ2VkKGRlbGV0ZUF1bGFfMS5kZWxldGVBdWxhSGFuZGxlcikpOw0KLy8gQWRpY2lvbmUgYSBub3ZhIHJvdGEgcGFyYSBzYWx2YXIgcHJvZ3Jlc3NvDQpyb3V0ZXIucG9zdCgnL2F1bGFzL3thdWxhSWR9L21pbmUnLCBhdXRoXzEuYXV0aC52ZXJpZnlMb2dnZWQoc2F2ZVByb2dyZXNzXzEuc2F2ZVByb2dyZXNzSGFuZGxlcikpOw0KdmFyIG1haW4gPSAoMCwgcm91dGVyXzEuYnVpbGRIYW5kbGVyKShyb3V0ZXIpOw0KZXhwb3J0cy5tYWluID0gbWFpbjsNCnZhciBhdWxhTW9kZWxfMSA9IHJlcXVpcmUoIkAvbW9kZWxzL2F1bGFNb2RlbCIpOw0KdmFyIGNyZWF0ZUF1bGEgPSBmdW5jdGlvbiAoZGF0YSkgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgbm92YUF1bGE7DQogICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkgew0KICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7DQogICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIGF1bGFNb2RlbF8xLkF1bGEuY3JlYXRlKGRhdGEpXTsNCiAgICAgICAgICAgIGNhc2UgMToNCiAgICAgICAgICAgICAgICBub3ZhQXVsYSA9IF9hLnNlbnQoKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbm92YUF1bGFdOw0KICAgICAgICB9DQogICAgfSk7DQp9KTsgfTsNCmV4cG9ydHMuY3JlYXRlQXVsYSA9IGNyZWF0ZUF1bGE7DQp2YXIgZGVsZXRlQXVsYSA9IGZ1bmN0aW9uIChhdWxhSWQpIHsgcmV0dXJuIF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7DQogICAgdmFyIGF1bGFFeGNsdWlkYTsNCiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7DQogICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHsNCiAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgYXVsYU1vZGVsXzEuQXVsYS5maW5kQnlJZEFuZERlbGV0ZShhdWxhSWQpXTsNCiAgICAgICAgICAgIGNhc2UgMToNCiAgICAgICAgICAgICAgICBhdWxhRXhjbHVpZGEgPSBfYS5zZW50KCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGF1bGFFeGNsdWlkYV07DQogICAgICAgIH0NCiAgICB9KTsNCn0pOyB9Ow0KZXhwb3J0cy5kZWxldGVBdWxhID0gZGVsZXRlQXVsYTsNCnZhciBnZXRBdWxhID0gZnVuY3Rpb24gKGF1bGFJZCkgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgYXVsYTsNCiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7DQogICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHsNCiAgICAgICAgICAgIGNhc2UgMDogcmV0dXJuIFs0IC8qeWllbGQqLywgYXVsYU1vZGVsXzEuQXVsYS5maW5kQnlJZChhdWxhSWQpXTsNCiAgICAgICAgICAgIGNhc2UgMToNCiAgICAgICAgICAgICAgICBhdWxhID0gX2Euc2VudCgpOw0KICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBhdWxhXTsNCiAgICAgICAgfQ0KICAgIH0pOw0KfSk7IH07DQpleHBvcnRzLmdldEF1bGEgPSBnZXRBdWxhOw0KdmFyIGxpc3RBdWxhcyA9IGZ1bmN0aW9uIChmaWx0cm8pIHsNCiAgICBpZiAoZmlsdHJvID09PSB2b2lkIDApIHsgZmlsdHJvID0ge307IH0NCiAgICByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIHF1ZXJ5LCBhdWxhczsNCiAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkgew0KICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkgew0KICAgICAgICAgICAgICAgIGNhc2UgMDoNCiAgICAgICAgICAgICAgICAgICAgcXVlcnkgPSB7fTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRyby50aXR1bG8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5LnRpdHVsbyA9IHsgJHJlZ2V4OiBmaWx0cm8udGl0dWxvLCAkb3B0aW9uczogJ2knIH07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRyby5kZXNjcmljYW8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5LmRlc2NyaWNhbyA9IHsgJHJlZ2V4OiBmaWx0cm8uZGVzY3JpY2FvLCAkb3B0aW9uczogJ2knIH07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKGZpbHRyby50ZW1WaWRlbyAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBxdWVyeS51cmxWaWRlbyA9IHsgJGV4aXN0czogZmlsdHJvLnRlbVZpZGVvIH07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYXVsYU1vZGVsXzEuQXVsYS5maW5kKHF1ZXJ5KV07DQogICAgICAgICAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgICAgICAgICBhdWxhcyA9IF9hLnNlbnQoKTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGF1bGFzXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSk7DQp9Ow0KZXhwb3J0cy5saXN0QXVsYXMgPSBsaXN0QXVsYXM7DQp2YXIgdXBkYXRlQXVsYSA9IGZ1bmN0aW9uIChkYXRhKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgew0KICAgIHZhciBhdWxhSWQsIGF0dWFsaXphY29lcywgYXVsYUF0dWFsaXphZGE7DQogICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkgew0KICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7DQogICAgICAgICAgICBjYXNlIDA6DQogICAgICAgICAgICAgICAgYXVsYUlkID0gZGF0YS5hdWxhSWQsIGF0dWFsaXphY29lcyA9IF9fcmVzdChkYXRhLCBbImF1bGFJZCJdKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBhdWxhTW9kZWxfMS5BdWxhLmZpbmRCeUlkQW5kVXBkYXRlKGF1bGFJZCwgeyAkc2V0OiBhdHVhbGl6YWNvZXMgfSwgeyBuZXc6IHRydWUgfSldOw0KICAgICAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgICAgIGF1bGFBdHVhbGl6YWRhID0gX2Euc2VudCgpOw0KICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBhdWxhQXR1YWxpemFkYV07DQogICAgICAgIH0NCiAgICB9KTsNCn0pOyB9Ow0KZXhwb3J0cy51cGRhdGVBdWxhID0gdXBkYXRlQXVsYTsNCnZhciBzYXZlUHJvZ3Jlc3MgPSBmdW5jdGlvbiAodXNlcklkLCBhdWxhSWQsIHByb2dyZXNzLCBwZXJmb3JtYW5jZSkgeyByZXR1cm4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHsNCiAgICB2YXIgYXVsYSwgdWx0aW1vUHJvZ3Jlc3NvOw0KICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHsNCiAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkgew0KICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBhdWxhTW9kZWxfMS5BdWxhLmZpbmRCeUlkKGF1bGFJZCldOw0KICAgICAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgICAgIGF1bGEgPSBfYS5zZW50KCk7DQogICAgICAgICAgICAgICAgaWYgKCFhdWxhKSB7DQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQXVsYSBuw6NvIGVuY29udHJhZGEnKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8gVmVyaWZpY2FyIHNlIGV4aXN0ZW0gcHJvZ3Jlc3NvcyBhbnRpZ29zDQogICAgICAgICAgICAgICAgaWYgKGF1bGEucHJvZ3Jlc3NQb3JVc3VhcmlvLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgdWx0aW1vUHJvZ3Jlc3NvID0gYXVsYS5wcm9ncmVzc1BvclVzdWFyaW9bYXVsYS5wcm9ncmVzc1BvclVzdWFyaW8ubGVuZ3RoIC0gMV07DQogICAgICAgICAgICAgICAgICAgIC8vIFZlcmlmaWNhciBzZSBvIMO6bHRpbW8gcHJvZ3Jlc3NvIG91IGEgcGVyZm9ybWFuY2Ugc8OjbyBkaWZlcmVudGVzDQogICAgICAgICAgICAgICAgICAgIGlmICh1bHRpbW9Qcm9ncmVzc28ucHJvZ3Jlc3MgIT09IHByb2dyZXNzIHx8IHVsdGltb1Byb2dyZXNzby5wZXJmb3JtYW5jZSAhPT0gcGVyZm9ybWFuY2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZXIgdG9kb3Mgb3MgcHJvZ3Jlc3NvcyBhbnRpZ29zDQogICAgICAgICAgICAgICAgICAgICAgICBhdWxhLnByb2dyZXNzUG9yVXN1YXJpby5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQudXNlcklkLnRvU3RyaW5nKCkgPT09IHVzZXJJZC50b1N0cmluZygpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGljaW9uYXIgbyBub3ZvIHByb2dyZXNzbw0KICAgICAgICAgICAgICAgICAgICAgICAgYXVsYS5wcm9ncmVzc1BvclVzdWFyaW8ucHVzaCh7IHVzZXJJZDogdXNlcklkLCBwcm9ncmVzczogcHJvZ3Jlc3MsIHBlcmZvcm1hbmNlOiBwZXJmb3JtYW5jZSB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAvLyBTZSBmb3JlbSBpZ3VhaXMsIG7Do28gZmF6IG5hZGENCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIC8vIENyaWUgdW0gbm92byBwcm9ncmVzc28gcGFyYSBvIHVzdcOhcmlvDQogICAgICAgICAgICAgICAgICAgIGF1bGEucHJvZ3Jlc3NQb3JVc3VhcmlvLnB1c2goeyB1c2VySWQ6IHVzZXJJZCwgcHJvZ3Jlc3M6IHByb2dyZXNzLCBwZXJmb3JtYW5jZTogcGVyZm9ybWFuY2UgfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIGF1bGEuc2F2ZSgpXTsNCiAgICAgICAgICAgIGNhc2UgMjoNCiAgICAgICAgICAgICAgICBfYS5zZW50KCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGF1bGFdOw0KICAgICAgICB9DQogICAgfSk7DQp9KTsgfTsNCmV4cG9ydHMuc2F2ZVByb2dyZXNzID0gc2F2ZVByb2dyZXNzOw0K"},{"version":3,"file":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\aulaService.ts","sourceRoot":"","sources":["C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\aulaService.ts"],"names":[],"mappings":"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","sourcesContent":["import { saveProgressHandler } from './saveProgress';  // Importe o novo handler\r\nimport { auth } from '@/lib/auth';  // Importe o módulo de autenticação\r\nimport mongoose from 'mongoose';\r\nimport { buildRouter, buildHandler } from '@/lib/router';\r\nimport { createAulaHandler } from './createAula';\r\nimport { deleteAulaHandler } from './deleteAula';\r\nimport { getAulaHandler } from './getAula';\r\nimport { listAulasHandler } from './listAulas';\r\nimport { updateAulaHandler } from './updateAula';\r\n\r\nconst router = buildRouter();\r\n\r\nrouter.post('/aulas', auth.verifyLogged(createAulaHandler));\r\nrouter.get('/aulas/{aulaId}', auth.verifyLogged(getAulaHandler));\r\nrouter.put('/aulas', auth.verifyLogged(updateAulaHandler));\r\nrouter.get('/aulas', auth.verifyLogged(listAulasHandler));\r\nrouter.delete('/aulas/{aulaId}', auth.verifyLogged(deleteAulaHandler));\r\n\r\n// Adicione a nova rota para salvar progresso\r\nrouter.post('/aulas/{aulaId}/mine', auth.verifyLogged(saveProgressHandler));\r\n\r\nconst main = buildHandler(router);\r\n\r\nexport { main };\r\n\r\nimport { Aula } from '@/models/aulaModel';\r\nimport { ICreateAula, IUpdateAula } from '@/types/IAula';\r\n\r\nconst createAula = async (data: ICreateAula) => {\r\n  const novaAula = await Aula.create(data);\r\n  return novaAula;\r\n};\r\n\r\nconst deleteAula = async (aulaId: string) => {\r\n  const aulaExcluida = await Aula.findByIdAndDelete(aulaId);\r\n  return aulaExcluida;\r\n};\r\n\r\nconst getAula = async (aulaId: string) => {\r\n  const aula = await Aula.findById(aulaId);\r\n  return aula;\r\n};\r\n\r\nconst listAulas = async (filtro: { titulo?: string; descricao?: string; temVideo?: boolean } = {}) => {\r\n  const query: any = {};\r\n\r\n  if (filtro.titulo) {\r\n    query.titulo = { $regex: filtro.titulo, $options: 'i' };\r\n  }\r\n\r\n  if (filtro.descricao) {\r\n    query.descricao = { $regex: filtro.descricao, $options: 'i' };\r\n  }\r\n\r\n  if (filtro.temVideo !== undefined) {\r\n    query.urlVideo = { $exists: filtro.temVideo };\r\n  }\r\n\r\n  const aulas = await Aula.find(query);\r\n  return aulas;\r\n};\r\n\r\nconst updateAula = async (data: IUpdateAula) => {\r\n  const { aulaId, ...atualizacoes } = data;\r\n  const aulaAtualizada = await Aula.findByIdAndUpdate(\r\n    aulaId,\r\n    { $set: atualizacoes },\r\n    { new: true }\r\n  );\r\n  return aulaAtualizada;\r\n};\r\n\r\nconst saveProgress = async (userId: string, aulaId: string, progress: number, performance: number) => {\r\n  const aula = await Aula.findById(aulaId);\r\n\r\n  if (!aula) {\r\n    throw new Error('Aula não encontrada');\r\n  }\r\n\r\n  // Verificar se existem progressos antigos\r\n  if (aula.progressPorUsuario.length > 0) {\r\n    // Pegar o último progresso\r\n    const ultimoProgresso = aula.progressPorUsuario[aula.progressPorUsuario.length - 1];\r\n\r\n    // Verificar se o último progresso ou a performance são diferentes\r\n    if (ultimoProgresso.progress !== progress || ultimoProgresso.performance !== performance) {\r\n      // Remover todos os progressos antigos\r\n      aula.progressPorUsuario.forEach(element => {\r\n        if (element.userId.toString() === userId.toString()) {\r\n          element.remove();\r\n        }\r\n      });\r\n      \r\n      // Adicionar o novo progresso\r\n      aula.progressPorUsuario.push({ userId, progress, performance });\r\n    }\r\n    // Se forem iguais, não faz nada\r\n  } else {\r\n    // Crie um novo progresso para o usuário\r\n    aula.progressPorUsuario.push({ userId, progress, performance });\r\n  }\r\n\r\n  await aula.save();\r\n  return aula;\r\n};\r\n\r\n\r\n\r\n\r\n\r\nexport { createAula, deleteAula, getAula, listAulas, updateAula, saveProgress };\r\n\r\n"]}]}