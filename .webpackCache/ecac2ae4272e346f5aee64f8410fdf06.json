{"remainingRequest":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js!C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\getIndicators.ts","dependencies":[{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\getIndicators.ts","mtime":1704660114755},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOw0KdmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7DQogICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9DQogICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH0NCiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQ0KICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7DQogICAgfSk7DQp9Ow0KdmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHsNCiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnOw0KICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCAidGhyb3ciOiB2ZXJiKDEpLCAicmV0dXJuIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnOw0KICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfQ0KICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHsNCiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTsNCiAgICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHsNCiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbInJldHVybiJdIDogb3BbMF0gPyB5WyJ0aHJvdyJdIHx8ICgodCA9IHlbInJldHVybiJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDsNCiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTsNCiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHsNCiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9Ow0KICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTsNCiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7DQogICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTsNCiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pOw0KICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9DQogICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9Ow0KICAgIH0NCn07DQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOw0KZXhwb3J0cy5nZXRJbmRpY2F0b3JzID0gdm9pZCAwOw0KdmFyIGF1bGFNb2RlbF8xID0gcmVxdWlyZSgiQC9tb2RlbHMvYXVsYU1vZGVsIik7DQp2YXIgZ2V0SW5kaWNhdG9ycyA9IGZ1bmN0aW9uIChyZXF1ZXN0LCBoKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgew0KICAgIHZhciBvcmRlckJ5LCBzb3J0T3B0aW9uLCBhdWxhcywgaW5kaWNhdG9ycywgZXJyb3JfMTsNCiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7DQogICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHsNCiAgICAgICAgICAgIGNhc2UgMDoNCiAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzAsIDIsICwgM10pOw0KICAgICAgICAgICAgICAgIG9yZGVyQnkgPSByZXF1ZXN0LnF1ZXJ5Lm9yZGVyQnk7DQogICAgICAgICAgICAgICAgc29ydE9wdGlvbiA9IHt9Ow0KICAgICAgICAgICAgICAgIGlmIChvcmRlckJ5KSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChvcmRlckJ5ID09PSAncGVyZm9ybWFuY2UnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzb3J0T3B0aW9uID0geyBtZWRpYVBlcmZvcm1hbmNlOiAtMSB9Ow0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9yZGVyQnkgPT09ICd0b3RhbEZpbmFsaXphZG9zJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgc29ydE9wdGlvbiA9IHsgZmluYWxpemFkb3M6IC0xIH07DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYXVsYU1vZGVsXzEuQXVsYS5maW5kKCkuc29ydChzb3J0T3B0aW9uKV07DQogICAgICAgICAgICBjYXNlIDE6DQogICAgICAgICAgICAgICAgYXVsYXMgPSBfYS5zZW50KCk7DQogICAgICAgICAgICAgICAgaW5kaWNhdG9ycyA9IGF1bGFzLm1hcChmdW5jdGlvbiAoYXVsYSkgew0KICAgICAgICAgICAgICAgICAgICB2YXIgdG90YWxGaW5hbGl6YWRvcyA9IGF1bGEuZmluYWxpemFkb3M7DQogICAgICAgICAgICAgICAgICAgIHZhciBtZWRpYVBlcmZvcm1hbmNlID0gYXVsYS5tZWRpYVBlcmZvcm1hbmNlOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICAgICAgICAgYXVsYUlkOiBhdWxhLl9pZCwNCiAgICAgICAgICAgICAgICAgICAgICAgIG5vbWU6IGF1bGEudGl0dWxvLA0KICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxGaW5hbGl6YWRvczogdG90YWxGaW5hbGl6YWRvcywNCiAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhUGVyZm9ybWFuY2U6IG1lZGlhUGVyZm9ybWFuY2UsDQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGluZGljYXRvcnNdOw0KICAgICAgICAgICAgY2FzZSAyOg0KICAgICAgICAgICAgICAgIGVycm9yXzEgPSBfYS5zZW50KCk7DQogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJybyBhbyBidXNjYXIgaW5kaWNhZG9yZXMgZGUgYXVsYXM6JywgZXJyb3JfMSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGgucmVzcG9uc2UoeyBlcnJvcjogJ0Vycm8gYW8gYnVzY2FyIGluZGljYWRvcmVzIGRlIGF1bGFzJyB9KS5jb2RlKDUwMCldOw0KICAgICAgICAgICAgY2FzZSAzOiByZXR1cm4gWzIgLypyZXR1cm4qL107DQogICAgICAgIH0NCiAgICB9KTsNCn0pOyB9Ow0KZXhwb3J0cy5nZXRJbmRpY2F0b3JzID0gZ2V0SW5kaWNhdG9yczsNCg=="},{"version":3,"file":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\getIndicators.ts","sourceRoot":"","sources":["C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\getIndicators.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,gDAA0C;AAE1C,IAAM,aAAa,GAAG,UAAO,OAAY,EAAE,CAAM;;;;;;gBAErC,OAAO,GAAK,OAAO,CAAC,KAAK,QAAlB,CAAmB;gBAE9B,UAAU,GAAG,EAAE,CAAC;gBAEpB,IAAI,OAAO,EAAE;oBACX,IAAI,OAAO,KAAK,aAAa,EAAE;wBAC7B,UAAU,GAAG,EAAE,gBAAgB,EAAE,CAAC,CAAC,EAAE,CAAC;qBACvC;yBACI,IAAI,OAAO,KAAK,kBAAkB,EAAE;wBACvC,UAAU,GAAG,EAAE,WAAW,EAAE,CAAC,CAAC,EAAE,CAAC;qBAClC;iBACF;gBAEa,qBAAM,gBAAI,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,EAAA;;gBAA1C,KAAK,GAAG,SAAkC;gBAE1C,UAAU,GAAG,KAAK,CAAC,GAAG,CAAC,UAAC,IAAI;oBAChC,IAAM,gBAAgB,GAAG,IAAI,CAAC,WAAW,CAAC;oBAC1C,IAAM,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,CAAC;oBAE/C,OAAO;wBACL,MAAM,EAAE,IAAI,CAAC,GAAG;wBAChB,IAAI,EAAE,IAAI,CAAC,MAAM;wBACjB,gBAAgB,kBAAA;wBAChB,gBAAgB,kBAAA;qBACjB,CAAC;gBACJ,CAAC,CAAC,CAAC;gBAEH,sBAAO,UAAU,EAAC;;;gBAElB,OAAO,CAAC,KAAK,CAAC,sCAAsC,EAAE,OAAK,CAAC,CAAC;gBAC7D,sBAAO,CAAC,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,qCAAqC,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAC;;;;KAEjF,CAAC;AAEO,sCAAa","sourcesContent":["import { Aula } from '@/models/aulaModel';\r\n\r\nconst getIndicators = async (request: any, h: any) => {\r\n  try {\r\n    const { orderBy } = request.query;\r\n\r\n    let sortOption = {};\r\n\r\n    if (orderBy) {\r\n      if (orderBy === 'performance') {\r\n        sortOption = { mediaPerformance: -1 };\r\n      }\r\n      else if (orderBy === 'totalFinalizados') {\r\n        sortOption = { finalizados: -1 };\r\n      }\r\n    }\r\n\r\n    const aulas = await Aula.find().sort(sortOption);\r\n\r\n    const indicators = aulas.map((aula) => {\r\n      const totalFinalizados = aula.finalizados;\r\n      const mediaPerformance = aula.mediaPerformance;\r\n\r\n      return {\r\n        aulaId: aula._id,\r\n        nome: aula.titulo,\r\n        totalFinalizados,\r\n        mediaPerformance,\r\n      };\r\n    });\r\n\r\n    return indicators;\r\n  } catch (error) {\r\n    console.error('Erro ao buscar indicadores de aulas:', error);\r\n    return h.response({ error: 'Erro ao buscar indicadores de aulas' }).code(500);\r\n  }\r\n};\r\n\r\nexport { getIndicators };\r\n"]}]}