{"remainingRequest":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js!C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\photo\\photoService.ts","dependencies":[{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\photo\\photoService.ts","mtime":1704632793092},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOw0KdmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7DQogICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9DQogICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH0NCiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQ0KICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7DQogICAgfSk7DQp9Ow0KdmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHsNCiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnOw0KICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCAidGhyb3ciOiB2ZXJiKDEpLCAicmV0dXJuIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnOw0KICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfQ0KICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHsNCiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTsNCiAgICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHsNCiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbInJldHVybiJdIDogb3BbMF0gPyB5WyJ0aHJvdyJdIHx8ICgodCA9IHlbInJldHVybiJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDsNCiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTsNCiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHsNCiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9Ow0KICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTsNCiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7DQogICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTsNCiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pOw0KICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9DQogICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9Ow0KICAgIH0NCn07DQp2YXIgX19yZWFkID0gKHRoaXMgJiYgdGhpcy5fX3JlYWQpIHx8IGZ1bmN0aW9uIChvLCBuKSB7DQogICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIG9bU3ltYm9sLml0ZXJhdG9yXTsNCiAgICBpZiAoIW0pIHJldHVybiBvOw0KICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlOw0KICAgIHRyeSB7DQogICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpOw0KICAgIH0NCiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH0NCiAgICBmaW5hbGx5IHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpWyJyZXR1cm4iXSkpIG0uY2FsbChpKTsNCiAgICAgICAgfQ0KICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH0NCiAgICB9DQogICAgcmV0dXJuIGFyOw0KfTsNCnZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHsNCiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykgew0KICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7DQogICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpOw0KICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldOw0KICAgICAgICB9DQogICAgfQ0KICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpOw0KfTsNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7DQpleHBvcnRzLmZldGNoUGhvdG9zID0gdm9pZCAwOw0KLy8gc3JjL2hhbmRsZXJzL3Bob3RvL3Bob3RvU2VydmljZS50cw0KdmFyIGF4aW9zXzEgPSByZXF1aXJlKCJheGlvcyIpOw0KdmFyIHBob3RvTW9kZWxfMSA9IHJlcXVpcmUoIkAvbW9kZWxzL3Bob3RvTW9kZWwiKTsNCnZhciBmZXRjaFBob3RvcyA9IGZ1bmN0aW9uIChzZWFyY2hUZXJtKSB7IHJldHVybiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkgew0KICAgIHZhciBwaXhhYmF5QXBpS2V5LCB1bnNwbGFzaEFwaUtleSwgcGV4ZWxzQXBpS2V5LCBwaXhhYmF5UmVzcG9uc2UsIHVuc3BsYXNoUmVzcG9uc2UsIHBleGVsc1Jlc3BvbnNlLCBlcnJvcl8xLCBlcnJvck1lc3NhZ2VzLCBwaXhhYmF5UGhvdG9zLCB1bnNwbGFzaFBob3RvcywgcGV4ZWxzUGhvdG9zLCBhbGxQaG90b3M7DQogICAgdmFyIF9hLCBfYjsNCiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9jKSB7DQogICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHsNCiAgICAgICAgICAgIGNhc2UgMDoNCiAgICAgICAgICAgICAgICAvLyBWZXJpZmljYSBzZSBvIHNlYXJjaFRlcm0gw6kgZm9ybmVjaWRvDQogICAgICAgICAgICAgICAgaWYgKCFzZWFyY2hUZXJtKSB7DQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTyBwYXLDom1ldHJvIHNlYXJjaFRlcm0gw6kgb2JyaWdhdMOzcmlvLicpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBwaXhhYmF5QXBpS2V5ID0gJzQxNjg1MjkxLWNkZDQ4YTEzOTE2NWQ1Y2NkNTI5ZGIwYWEnOw0KICAgICAgICAgICAgICAgIHVuc3BsYXNoQXBpS2V5ID0gJ0tUc0VrTHhlSmFueTEzdm9uV050ZmZsWklDRXhISjIzdWwyTlJ5RVV1bTgnOw0KICAgICAgICAgICAgICAgIHBleGVsc0FwaUtleSA9ICdNNGJBaFVBOFZmM1VWT2cwYnk2MHNuejdOcHhtbEUydnVURzVib21Jck9BcjJJSnF4MlJ5THk1Nyc7DQogICAgICAgICAgICAgICAgX2MubGFiZWwgPSAxOw0KICAgICAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgICAgIF9jLnRyeXMucHVzaChbMSwgNSwgLCA2XSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYXhpb3NfMS5kZWZhdWx0LmdldCgiaHR0cHM6Ly9waXhhYmF5LmNvbS9hcGkvP2tleT0iLmNvbmNhdChwaXhhYmF5QXBpS2V5LCAiJnE9IikuY29uY2F0KHNlYXJjaFRlcm0pKV07DQogICAgICAgICAgICBjYXNlIDI6DQogICAgICAgICAgICAgICAgLy8gVXNlIEF4aW9zIHBhcmEgZmF6ZXIgY2hhbWFkYXMgw6BzIEFQSXMNCiAgICAgICAgICAgICAgICBwaXhhYmF5UmVzcG9uc2UgPSBfYy5zZW50KCk7DQogICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgYXhpb3NfMS5kZWZhdWx0LmdldCgiaHR0cHM6Ly9hcGkudW5zcGxhc2guY29tL3Bob3Rvcz9jbGllbnRfaWQ9Ii5jb25jYXQodW5zcGxhc2hBcGlLZXksICImcXVlcnk9IikuY29uY2F0KHNlYXJjaFRlcm0pKV07DQogICAgICAgICAgICBjYXNlIDM6DQogICAgICAgICAgICAgICAgdW5zcGxhc2hSZXNwb25zZSA9IF9jLnNlbnQoKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBheGlvc18xLmRlZmF1bHQuZ2V0KCJodHRwczovL2FwaS5wZXhlbHMuY29tL3YxL3NlYXJjaD9xdWVyeT0iLmNvbmNhdChzZWFyY2hUZXJtKSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiBwZXhlbHNBcGlLZXkgfSwNCiAgICAgICAgICAgICAgICAgICAgfSldOw0KICAgICAgICAgICAgY2FzZSA0Og0KICAgICAgICAgICAgICAgIHBleGVsc1Jlc3BvbnNlID0gX2Muc2VudCgpOw0KICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDZdOw0KICAgICAgICAgICAgY2FzZSA1Og0KICAgICAgICAgICAgICAgIGVycm9yXzEgPSBfYy5zZW50KCk7DQogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlcyA9IHsNCiAgICAgICAgICAgICAgICAgICAgcGl4YWJheTogKCgoX2EgPSBlcnJvcl8xLnJlc3BvbnNlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZGF0YSkgfHwge30pLm1lc3NhZ2UgfHwgJ0Vycm8gbmEgY2hhbWFkYSBkYSBBUEkgUGl4YWJheS4nLA0KICAgICAgICAgICAgICAgICAgICB1bnNwbGFzaDogZXJyb3JfMS5tZXNzYWdlIHx8ICdFcnJvIG5hIGNoYW1hZGEgZGEgQVBJIFVuc3BsYXNoLicsDQogICAgICAgICAgICAgICAgICAgIHBleGVsczogKCgoX2IgPSBlcnJvcl8xLnJlc3BvbnNlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZGF0YSkgfHwge30pLm1lc3NhZ2UgfHwgJ0Vycm8gbmEgY2hhbWFkYSBkYSBBUEkgUGV4ZWxzLicsDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkVycm8gYW8gYnVzY2FyIGZvdG9zOiAiLmNvbmNhdChlcnJvck1lc3NhZ2VzLnBpeGFiYXksICIgfCAiKS5jb25jYXQoZXJyb3JNZXNzYWdlcy51bnNwbGFzaCwgIiB8ICIpLmNvbmNhdChlcnJvck1lc3NhZ2VzLnBleGVscykpOw0KICAgICAgICAgICAgY2FzZSA2Og0KICAgICAgICAgICAgICAgIHBpeGFiYXlQaG90b3MgPSBwaXhhYmF5UmVzcG9uc2UuZGF0YS5oaXRzLm1hcChmdW5jdGlvbiAoaGl0KSB7IHJldHVybiAoew0KICAgICAgICAgICAgICAgICAgICBzb3VyY2U6ICdQaXhhYmF5JywNCiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGhpdC50YWdzLA0KICAgICAgICAgICAgICAgICAgICB1cmw6IGhpdC53ZWJmb3JtYXRVUkwsDQogICAgICAgICAgICAgICAgfSk7IH0pOw0KICAgICAgICAgICAgICAgIHVuc3BsYXNoUGhvdG9zID0gdW5zcGxhc2hSZXNwb25zZS5kYXRhLm1hcChmdW5jdGlvbiAocGhvdG8pIHsgcmV0dXJuICh7DQogICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ1Vuc3BsYXNoJywNCiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHBob3RvLmFsdF9kZXNjcmlwdGlvbiwNCiAgICAgICAgICAgICAgICAgICAgdXJsOiBwaG90by51cmxzLnJlZ3VsYXIsDQogICAgICAgICAgICAgICAgfSk7IH0pOw0KICAgICAgICAgICAgICAgIHBleGVsc1Bob3RvcyA9IHBleGVsc1Jlc3BvbnNlLmRhdGEucGhvdG9zLm1hcChmdW5jdGlvbiAocGhvdG8pIHsgcmV0dXJuICh7DQogICAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ1BleGVscycsDQogICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBwaG90by51cmwsDQogICAgICAgICAgICAgICAgICAgIHVybDogcGhvdG8uc3JjLm9yaWdpbmFsLA0KICAgICAgICAgICAgICAgIH0pOyB9KTsNCiAgICAgICAgICAgICAgICBhbGxQaG90b3MgPSBfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgX19yZWFkKHBpeGFiYXlQaG90b3MpLCBmYWxzZSksIF9fcmVhZCh1bnNwbGFzaFBob3RvcyksIGZhbHNlKSwgX19yZWFkKHBleGVsc1Bob3RvcyksIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAvLyBWZXJpZmljYXIgc2UgcGVsbyBtZW5vcyB1bWEgQVBJIHJldG9ybm91IGZvdG9zDQogICAgICAgICAgICAgICAgaWYgKGFsbFBob3Rvcy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOZW5odW1hIGZvdG8gZW5jb250cmFkYS4nKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgLy8gU2FsdmFyIGFzIGZvdG9zIG5vIGJhbmNvIGRlIGRhZG9zDQogICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgcGhvdG9Nb2RlbF8xLlBob3RvLmluc2VydE1hbnkoYWxsUGhvdG9zKV07DQogICAgICAgICAgICBjYXNlIDc6DQogICAgICAgICAgICAgICAgLy8gU2FsdmFyIGFzIGZvdG9zIG5vIGJhbmNvIGRlIGRhZG9zDQogICAgICAgICAgICAgICAgX2Muc2VudCgpOw0KICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBhbGxQaG90b3NdOw0KICAgICAgICB9DQogICAgfSk7DQp9KTsgfTsNCmV4cG9ydHMuZmV0Y2hQaG90b3MgPSBmZXRjaFBob3RvczsNCg=="},{"version":3,"file":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\photo\\photoService.ts","sourceRoot":"","sources":["C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\photo\\photoService.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,qCAAqC;AACrC,+BAA6C;AAC7C,kDAA4C;AAE5C,IAAM,WAAW,GAAG,UAAO,UAAkB;;;;;;gBAC3C,uCAAuC;gBACvC,IAAI,CAAC,UAAU,EAAE;oBACf,MAAM,IAAI,KAAK,CAAC,uCAAuC,CAAC,CAAC;iBAC1D;gBAEK,aAAa,GAAG,oCAAoC,CAAC;gBACrD,cAAc,GAAG,6CAA6C,CAAC;gBAC/D,YAAY,GAAG,0DAA0D,CAAC;;;;gBAQ5D,qBAAM,eAAK,CAAC,GAAG,CAAC,uCAAgC,aAAa,gBAAM,UAAU,CAAE,CAAC,EAAA;;gBADlG,wCAAwC;gBACxC,eAAe,GAAG,SAAgF,CAAC;gBAChF,qBAAM,eAAK,CAAC,GAAG,CAAC,oDAA6C,cAAc,oBAAU,UAAU,CAAE,CAAC,EAAA;;gBAArH,gBAAgB,GAAG,SAAkG,CAAC;gBACrG,qBAAM,eAAK,CAAC,GAAG,CAAC,iDAA0C,UAAU,CAAE,EAAE;wBACvF,OAAO,EAAE,EAAE,aAAa,EAAE,YAAY,EAAE;qBACzC,CAAC,EAAA;;gBAFF,cAAc,GAAG,SAEf,CAAC;;;;gBAGG,aAAa,GAAG;oBACpB,OAAO,EAAE,CAAC,CAAA,MAAA,OAAK,CAAC,QAAQ,0CAAE,IAAI,KAAI,EAAE,CAAC,CAAC,OAAO,IAAI,iCAAiC;oBAClF,QAAQ,EAAE,OAAK,CAAC,OAAO,IAAI,kCAAkC;oBAC7D,MAAM,EAAE,CAAC,CAAA,MAAA,OAAK,CAAC,QAAQ,0CAAE,IAAI,KAAI,EAAE,CAAC,CAAC,OAAO,IAAI,gCAAgC;iBACjF,CAAC;gBACF,MAAM,IAAI,KAAK,CAAC,gCAAyB,aAAa,CAAC,OAAO,gBAAM,aAAa,CAAC,QAAQ,gBAAM,aAAa,CAAC,MAAM,CAAE,CAAC,CAAC;;gBAIpH,aAAa,GAAG,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,UAAC,GAAQ,IAAK,OAAA,CAAC;oBACjE,MAAM,EAAE,SAAS;oBACjB,WAAW,EAAE,GAAG,CAAC,IAAI;oBACrB,GAAG,EAAE,GAAG,CAAC,YAAY;iBACtB,CAAC,EAJgE,CAIhE,CAAC,CAAC;gBAEE,cAAc,GAAG,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,UAAC,KAAU,IAAK,OAAA,CAAC;oBAChE,MAAM,EAAE,UAAU;oBAClB,WAAW,EAAE,KAAK,CAAC,eAAe;oBAClC,GAAG,EAAE,KAAK,CAAC,IAAI,CAAC,OAAO;iBACxB,CAAC,EAJ+D,CAI/D,CAAC,CAAC;gBAEE,YAAY,GAAG,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,UAAC,KAAU,IAAK,OAAA,CAAC;oBACnE,MAAM,EAAE,QAAQ;oBAChB,WAAW,EAAE,KAAK,CAAC,GAAG;oBACtB,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,QAAQ;iBACxB,CAAC,EAJkE,CAIlE,CAAC,CAAC;gBAEE,SAAS,wDAAO,aAAa,kBAAK,cAAc,kBAAK,YAAY,SAAC,CAAC;gBAEzE,iDAAiD;gBACjD,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;oBAC1B,MAAM,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC;iBAC7C;gBAED,oCAAoC;gBACpC,qBAAM,kBAAK,CAAC,UAAU,CAAC,SAAS,CAAC,EAAA;;gBADjC,oCAAoC;gBACpC,SAAiC,CAAC;gBAElC,sBAAO,SAAS,EAAC;;;KAClB,CAAC;AAEO,kCAAW","sourcesContent":["// src/handlers/photo/photoService.ts\r\nimport axios, { AxiosResponse } from 'axios';\r\nimport { Photo } from '@/models/photoModel';\r\n\r\nconst fetchPhotos = async (searchTerm: string) => {\r\n  // Verifica se o searchTerm é fornecido\r\n  if (!searchTerm) {\r\n    throw new Error('O parâmetro searchTerm é obrigatório.');\r\n  }\r\n\r\n  const pixabayApiKey = '41685291-cdd48a139165d5ccd529db0aa';\r\n  const unsplashApiKey = 'KTsEkLxeJany13vonWNtfflZICExHJ23ul2NRyEUum8';\r\n  const pexelsApiKey = 'M4bAhUA8Vf3UVOg0by60snz7NpxmlE2vuTG5bomIrOAr2IJqx2RyLy57';\r\n\r\n  let pixabayResponse: AxiosResponse;\r\n  let unsplashResponse: AxiosResponse;\r\n  let pexelsResponse: AxiosResponse;\r\n\r\n  try {\r\n    // Use Axios para fazer chamadas às APIs\r\n    pixabayResponse = await axios.get(`https://pixabay.com/api/?key=${pixabayApiKey}&q=${searchTerm}`);\r\n    unsplashResponse = await axios.get(`https://api.unsplash.com/photos?client_id=${unsplashApiKey}&query=${searchTerm}`);\r\n    pexelsResponse = await axios.get(`https://api.pexels.com/v1/search?query=${searchTerm}`, {\r\n      headers: { Authorization: pexelsApiKey },\r\n    });\r\n  } catch (error) {\r\n    // Lidar com erros durante as chamadas da API\r\n    const errorMessages = {\r\n      pixabay: (error.response?.data || {}).message || 'Erro na chamada da API Pixabay.',\r\n      unsplash: error.message || 'Erro na chamada da API Unsplash.',\r\n      pexels: (error.response?.data || {}).message || 'Erro na chamada da API Pexels.',\r\n    };\r\n    throw new Error(`Erro ao buscar fotos: ${errorMessages.pixabay} | ${errorMessages.unsplash} | ${errorMessages.pexels}`);\r\n  }\r\n\r\n  // Extrair dados relevantes da resposta e armazenar no banco de dados\r\n  const pixabayPhotos = pixabayResponse.data.hits.map((hit: any) => ({\r\n    source: 'Pixabay',\r\n    description: hit.tags,\r\n    url: hit.webformatURL,\r\n  }));\r\n\r\n  const unsplashPhotos = unsplashResponse.data.map((photo: any) => ({\r\n    source: 'Unsplash',\r\n    description: photo.alt_description,\r\n    url: photo.urls.regular,\r\n  }));\r\n\r\n  const pexelsPhotos = pexelsResponse.data.photos.map((photo: any) => ({\r\n    source: 'Pexels',\r\n    description: photo.url,\r\n    url: photo.src.original,\r\n  }));\r\n\r\n  const allPhotos = [...pixabayPhotos, ...unsplashPhotos, ...pexelsPhotos];\r\n\r\n  // Verificar se pelo menos uma API retornou fotos\r\n  if (allPhotos.length === 0) {\r\n    throw new Error('Nenhuma foto encontrada.');\r\n  }\r\n\r\n  // Salvar as fotos no banco de dados\r\n  await Photo.insertMany(allPhotos);\r\n\r\n  return allPhotos;\r\n};\r\n\r\nexport { fetchPhotos };\r\n"]}]}