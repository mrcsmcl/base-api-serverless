{"remainingRequest":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js!C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\lib\\mongooseErrorValidator.ts","dependencies":[{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\lib\\mongooseErrorValidator.ts","mtime":1704481060435},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOw0KT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsNCmV4cG9ydHMubW9uZ29vc2VFcnJvclZhbGlkYXRvciA9IHZvaWQgMDsNCi8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi8NCnZhciBlcnJvcl8xID0gcmVxdWlyZSgiQC9saWIvZXJyb3IiKTsNCnZhciBtb25nb29zZUVycm9yVmFsaWRhdG9yID0gZnVuY3Rpb24gKHNjaGVtYSkgew0KICAgIHZhciBjaGFuZ2VUb0ludmFsaWRTY2hlbWFFcnJvciA9IGZ1bmN0aW9uIChlcnIsIF8sIG5leHQpIHsNCiAgICAgICAgaWYgKGVycikgew0KICAgICAgICAgICAgcmV0dXJuIG5leHQoZXJyb3JfMS5lcnJvci5idWlsZEludmFsaWRVcGRhdGVJbnB1dEVycm9yKGVycikpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBuZXh0KCk7DQogICAgfTsNCiAgICB2YXIgY2F0Y2hJbnZhbGlkU2NoZW1hID0gZnVuY3Rpb24gKGVyciwgXywgbmV4dCkgew0KICAgICAgICBpZiAoZXJyKSB7DQogICAgICAgICAgICByZXR1cm4gbmV4dChlcnJvcl8xLmVycm9yLmJ1aWxkU2NoZW1hVmFsaWRhdGlvbkVycm9yKGVycikpOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBuZXh0KCk7DQogICAgfTsNCiAgICBzY2hlbWEucG9zdCgndmFsaWRhdGUnLCBjYXRjaEludmFsaWRTY2hlbWEpOw0KICAgIHNjaGVtYS5wb3N0KCdmaW5kT25lQW5kVXBkYXRlJywgY2hhbmdlVG9JbnZhbGlkU2NoZW1hRXJyb3IpOw0KfTsNCmV4cG9ydHMubW9uZ29vc2VFcnJvclZhbGlkYXRvciA9IG1vbmdvb3NlRXJyb3JWYWxpZGF0b3I7DQo="},{"version":3,"file":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\lib\\mongooseErrorValidator.ts","sourceRoot":"","sources":["C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\lib\\mongooseErrorValidator.ts"],"names":[],"mappings":";;;AAAA,+BAA+B;AAC/B,qCAAmC;AAGnC,IAAM,sBAAsB,GAAG,UAAC,MAAM;IACpC,IAAM,0BAA0B,GAAG,UAAC,GAAmC,EAAE,CAAM,EAAE,IAA0B;QACzG,IAAI,GAAG,EAAE;YACP,OAAO,IAAI,CAAC,aAAK,CAAC,4BAA4B,CAAC,GAAG,CAAC,CAAC,CAAA;SACrD;QACD,OAAO,IAAI,EAAE,CAAA;IACf,CAAC,CAAA;IAED,IAAM,kBAAkB,GAAG,UAAC,GAAmC,EAAE,CAAM,EAAE,IAA0B;QACjG,IAAI,GAAG,EAAE;YACP,OAAO,IAAI,CAAC,aAAK,CAAC,0BAA0B,CAAC,GAAG,CAAC,CAAC,CAAA;SACnD;QACD,OAAO,IAAI,EAAE,CAAA;IACf,CAAC,CAAA;IAED,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE,kBAAkB,CAAC,CAAA;IAC3C,MAAM,CAAC,IAAI,CAAC,kBAAkB,EAAE,0BAA0B,CAAC,CAAA;AAC7D,CAAC,CAAA;AAGC,wDAAsB","sourcesContent":["/* eslint-disable no-console */\r\nimport { error } from '@/lib/error'\r\nimport * as mongoose from 'mongoose'\r\n\r\nconst mongooseErrorValidator = (schema) => {\r\n  const changeToInvalidSchemaError = (err: mongoose.Error.ValidationError, _: any, next: (arg0?: any) => void) => {\r\n    if (err) {\r\n      return next(error.buildInvalidUpdateInputError(err))\r\n    }\r\n    return next()\r\n  }\r\n\r\n  const catchInvalidSchema = (err: mongoose.Error.ValidationError, _: any, next: (arg0?: any) => void) => {\r\n    if (err) {\r\n      return next(error.buildSchemaValidationError(err))\r\n    }\r\n    return next()\r\n  }\r\n\r\n  schema.post('validate', catchInvalidSchema)\r\n  schema.post('findOneAndUpdate', changeToInvalidSchemaError)\r\n}\r\n\r\nexport {\r\n  mongooseErrorValidator\r\n}\r\n"]}]}