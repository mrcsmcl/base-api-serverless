{"remainingRequest":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js!C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\saveProgress.ts","dependencies":[{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\saveProgress.ts","mtime":1704563468874},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\node_modules\\ts-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOw0KdmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7DQogICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9DQogICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH0NCiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbInRocm93Il0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfQ0KICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7DQogICAgfSk7DQp9Ow0KdmFyIF9fZ2VuZXJhdG9yID0gKHRoaXMgJiYgdGhpcy5fX2dlbmVyYXRvcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHsNCiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnOw0KICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCAidGhyb3ciOiB2ZXJiKDEpLCAicmV0dXJuIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnOw0KICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfQ0KICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHsNCiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTsNCiAgICAgICAgd2hpbGUgKGcgJiYgKGcgPSAwLCBvcFswXSAmJiAoXyA9IDApKSwgXykgdHJ5IHsNCiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbInJldHVybiJdIDogb3BbMF0gPyB5WyJ0aHJvdyJdIHx8ICgodCA9IHlbInJldHVybiJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDsNCiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTsNCiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHsNCiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9Ow0KICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTsNCiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7DQogICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfQ0KICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9DQogICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTsNCiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pOw0KICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9DQogICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9Ow0KICAgIH0NCn07DQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOw0KZXhwb3J0cy5zYXZlUHJvZ3Jlc3NIYW5kbGVyID0gdm9pZCAwOw0KdmFyIGF1bGFTZXJ2aWNlXzEgPSByZXF1aXJlKCIuL2F1bGFTZXJ2aWNlIik7DQp2YXIgc2F2ZVByb2dyZXNzSGFuZGxlciA9IGZ1bmN0aW9uIChfYSkgew0KICAgIHZhciBwYXRoUGFyYW1ldGVycyA9IF9hLnBhdGhQYXJhbWV0ZXJzLCBib2R5ID0gX2EuYm9keSwgdXNlciA9IF9hLnVzZXI7DQogICAgcmV0dXJuIF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBhdWxhSWQsIHByb2dyZXNzLCBwZXJmb3JtYW5jZSwgYXVsYUF0dWFsLCBhdWxhLCBlcnJvcl8xOw0KICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9iKSB7DQogICAgICAgICAgICBzd2l0Y2ggKF9iLmxhYmVsKSB7DQogICAgICAgICAgICAgICAgY2FzZSAwOg0KICAgICAgICAgICAgICAgICAgICBfYi50cnlzLnB1c2goWzAsIDMsICwgNF0pOw0KICAgICAgICAgICAgICAgICAgICBhdWxhSWQgPSBwYXRoUGFyYW1ldGVycy5hdWxhSWQ7DQogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzID0gYm9keS5wcm9ncmVzcywgcGVyZm9ybWFuY2UgPSBib2R5LnBlcmZvcm1hbmNlOw0KICAgICAgICAgICAgICAgICAgICAvLyBWZXJpZmlxdWUgc2UgYXVsYUlkLCBwcm9ncmVzcyBlIHBlcmZvcm1hbmNlIGVzdMOjbyBwcmVzZW50ZXMNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFhdWxhSWQgfHwgIXByb2dyZXNzIHx8ICFwZXJmb3JtYW5jZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQYXLDom1ldHJvcyBpbnbDoWxpZG9zJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKDAsIGF1bGFTZXJ2aWNlXzEuZ2V0QXVsYSkoYXVsYUlkKV07DQogICAgICAgICAgICAgICAgY2FzZSAxOg0KICAgICAgICAgICAgICAgICAgICBhdWxhQXR1YWwgPSBfYi5zZW50KCk7DQogICAgICAgICAgICAgICAgICAgIC8vIFZlcmlmaXF1ZSBzZSBhIGF1bGEgbsOjbyDDqSBudWxhIGUgc2UgasOhIGVzdMOhIGZpbmFsaXphZGENCiAgICAgICAgICAgICAgICAgICAgaWYgKGF1bGFBdHVhbCAhPT0gbnVsbCAmJiBhdWxhQXR1YWwucHJvZ3Jlc3NQb3JVc3VhcmlvLnNvbWUoZnVuY3Rpb24gKHByb2dyZXNzKSB7IHJldHVybiBwcm9ncmVzcy5wcm9ncmVzcyA9PT0gMTAwOyB9KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBdWxhIGrDoSBmaW5hbGl6YWRhLCBuw6NvIMOpIHBvc3PDrXZlbCBhdHVhbGl6YXIgbyBwcm9ncmVzc28uJyk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgKDAsIGF1bGFTZXJ2aWNlXzEuc2F2ZVByb2dyZXNzKSh1c2VyLl9pZCwgYXVsYUlkLCBwcm9ncmVzcywgcGVyZm9ybWFuY2UpXTsNCiAgICAgICAgICAgICAgICBjYXNlIDI6DQogICAgICAgICAgICAgICAgICAgIGF1bGEgPSBfYi5zZW50KCk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCB7IGF1bGE6IGF1bGEgfV07DQogICAgICAgICAgICAgICAgY2FzZSAzOg0KICAgICAgICAgICAgICAgICAgICBlcnJvcl8xID0gX2Iuc2VudCgpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgeyBlcnJvcjogZXJyb3JfMS5tZXNzYWdlIH1dOw0KICAgICAgICAgICAgICAgIGNhc2UgNDogcmV0dXJuIFsyIC8qcmV0dXJuKi9dOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9KTsNCn07DQpleHBvcnRzLnNhdmVQcm9ncmVzc0hhbmRsZXIgPSBzYXZlUHJvZ3Jlc3NIYW5kbGVyOw0K"},{"version":3,"file":"C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\saveProgress.ts","sourceRoot":"","sources":["C:\\Users\\mrcsm\\Desktop\\base-api-serverless\\src\\handlers\\aulas\\saveProgress.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,6CAAsD;AAGtD,IAAM,mBAAmB,GAAG,UAAO,EAA8B;QAA5B,cAAc,oBAAA,EAAE,IAAI,UAAA,EAAE,IAAI,UAAA;;;;;;;oBAEnD,MAAM,GAAK,cAAc,OAAnB,CAAoB;oBAC1B,QAAQ,GAAkB,IAAI,SAAtB,EAAE,WAAW,GAAK,IAAI,YAAT,CAAU;oBAEvC,8DAA8D;oBAC9D,IAAI,CAAC,MAAM,IAAI,CAAC,QAAQ,IAAI,CAAC,WAAW,EAAE;wBACxC,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;qBACzC;oBAGiB,qBAAM,IAAA,qBAAO,EAAC,MAAM,CAAC,EAAA;;oBAAjC,SAAS,GAAG,SAAqB;oBAEzC,yDAAyD;oBACzD,IAAI,SAAS,KAAK,IAAI,IAAI,SAAS,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAC,QAAQ,IAAK,OAAA,QAAQ,CAAC,QAAQ,KAAK,GAAG,EAAzB,CAAyB,CAAC,EAAE;wBACpG,MAAM,IAAI,KAAK,CAAC,2DAA2D,CAAC,CAAC;qBAC9E;oBAEc,qBAAM,IAAA,0BAAY,EAAC,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,CAAC,EAAA;;oBAAlE,IAAI,GAAG,SAA2D;oBACxE,sBAAO,EAAE,IAAI,MAAA,EAAE,EAAC;;;oBAEhB,sBAAO,EAAE,KAAK,EAAE,OAAK,CAAC,OAAO,EAAE,EAAC;;;;;CAEnC,CAAC;AAGO,kDAAmB","sourcesContent":["import { getAula, saveProgress } from './aulaService';\r\n\r\n\r\nconst saveProgressHandler = async ({ pathParameters, body, user }) => {\r\n  try {\r\n    const { aulaId } = pathParameters;\r\n    const { progress, performance } = body;\r\n\r\n    // Verifique se aulaId, progress e performance estão presentes\r\n    if (!aulaId || !progress || !performance) {\r\n      throw new Error('Parâmetros inválidos');\r\n    }\r\n\r\n    // Obtenha a aula atual\r\n    const aulaAtual = await getAula(aulaId);\r\n\r\n  // Verifique se a aula não é nula e se já está finalizada\r\n  if (aulaAtual !== null && aulaAtual.progressPorUsuario.some((progress) => progress.progress === 100)) {\r\n    throw new Error('Aula já finalizada, não é possível atualizar o progresso.');\r\n  }\r\n    // Atualize o progresso apenas se não estiver finalizada, passando o userId\r\n    const aula = await saveProgress(user._id, aulaId, progress, performance);\r\n    return { aula };\r\n  } catch (error) {\r\n    return { error: error.message };\r\n  }\r\n};\r\n\r\n\r\nexport { saveProgressHandler };"]}]}